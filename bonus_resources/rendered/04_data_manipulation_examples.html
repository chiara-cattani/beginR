<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Manipulation Examples</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="data_manipulation_examples_files/libs/clipboard/clipboard.min.js"></script>
<script src="data_manipulation_examples_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="data_manipulation_examples_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="data_manipulation_examples_files/libs/quarto-html/popper.min.js"></script>
<script src="data_manipulation_examples_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data_manipulation_examples_files/libs/quarto-html/anchor.min.js"></script>
<link href="data_manipulation_examples_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data_manipulation_examples_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data_manipulation_examples_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data_manipulation_examples_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data_manipulation_examples_files/libs/bootstrap/bootstrap-6e5ff12f349f7d7ee99023e5a7f49be9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-manipulation-examples" id="toc-data-manipulation-examples" class="nav-link active" data-scroll-target="#data-manipulation-examples">ðŸ“Š Data Manipulation Examples</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#required-libraries" id="toc-required-libraries" class="nav-link" data-scroll-target="#required-libraries">Required Libraries</a></li>
  <li><a href="#sample-sdtm-datasets" id="toc-sample-sdtm-datasets" class="nav-link" data-scroll-target="#sample-sdtm-datasets">Sample SDTM Datasets</a>
  <ul class="collapse">
  <li><a href="#demographics-domain-dm" id="toc-demographics-domain-dm" class="nav-link" data-scroll-target="#demographics-domain-dm">Demographics Domain (DM)</a></li>
  <li><a href="#vital-signs-domain-vs" id="toc-vital-signs-domain-vs" class="nav-link" data-scroll-target="#vital-signs-domain-vs">Vital Signs Domain (VS)</a></li>
  <li><a href="#adverse-events-domain-ae" id="toc-adverse-events-domain-ae" class="nav-link" data-scroll-target="#adverse-events-domain-ae">Adverse Events Domain (AE)</a></li>
  </ul></li>
  <li><a href="#core-dplyr-operations" id="toc-core-dplyr-operations" class="nav-link" data-scroll-target="#core-dplyr-operations">Core dplyr Operations</a>
  <ul class="collapse">
  <li><a href="#selecting-columns" id="toc-selecting-columns" class="nav-link" data-scroll-target="#selecting-columns">1. Selecting Columns</a></li>
  <li><a href="#filtering-rows" id="toc-filtering-rows" class="nav-link" data-scroll-target="#filtering-rows">2. Filtering Rows</a></li>
  <li><a href="#creating-new-variables" id="toc-creating-new-variables" class="nav-link" data-scroll-target="#creating-new-variables">3. Creating New Variables</a></li>
  <li><a href="#arranging-data" id="toc-arranging-data" class="nav-link" data-scroll-target="#arranging-data">4. Arranging Data</a></li>
  </ul></li>
  <li><a href="#group-operations-and-summaries" id="toc-group-operations-and-summaries" class="nav-link" data-scroll-target="#group-operations-and-summaries">Group Operations and Summaries</a>
  <ul class="collapse">
  <li><a href="#basic-grouping-and-summarization" id="toc-basic-grouping-and-summarization" class="nav-link" data-scroll-target="#basic-grouping-and-summarization">1. Basic Grouping and Summarization</a></li>
  <li><a href="#advanced-grouping-operations" id="toc-advanced-grouping-operations" class="nav-link" data-scroll-target="#advanced-grouping-operations">2. Advanced Grouping Operations</a></li>
  </ul></li>
  <li><a href="#data-joining-operations" id="toc-data-joining-operations" class="nav-link" data-scroll-target="#data-joining-operations">Data Joining Operations</a>
  <ul class="collapse">
  <li><a href="#inner-joins" id="toc-inner-joins" class="nav-link" data-scroll-target="#inner-joins">1. Inner Joins</a></li>
  <li><a href="#complex-joins-with-vital-signs" id="toc-complex-joins-with-vital-signs" class="nav-link" data-scroll-target="#complex-joins-with-vital-signs">2. Complex Joins with Vital Signs</a></li>
  </ul></li>
  <li><a href="#advanced-data-manipulation" id="toc-advanced-data-manipulation" class="nav-link" data-scroll-target="#advanced-data-manipulation">Advanced Data Manipulation</a>
  <ul class="collapse">
  <li><a href="#conditional-operations" id="toc-conditional-operations" class="nav-link" data-scroll-target="#conditional-operations">1. Conditional Operations</a></li>
  <li><a href="#string-manipulation" id="toc-string-manipulation" class="nav-link" data-scroll-target="#string-manipulation">2. String Manipulation</a></li>
  <li><a href="#window-functions" id="toc-window-functions" class="nav-link" data-scroll-target="#window-functions">3. Window Functions</a></li>
  </ul></li>
  <li><a href="#summary-statistics-by-group" id="toc-summary-statistics-by-group" class="nav-link" data-scroll-target="#summary-statistics-by-group">Summary Statistics by Group</a>
  <ul class="collapse">
  <li><a href="#treatment-group-comparisons" id="toc-treatment-group-comparisons" class="nav-link" data-scroll-target="#treatment-group-comparisons">1. Treatment Group Comparisons</a></li>
  <li><a href="#site-level-analysis" id="toc-site-level-analysis" class="nav-link" data-scroll-target="#site-level-analysis">2. Site-Level Analysis</a></li>
  </ul></li>
  <li><a href="#best-practices-summary" id="toc-best-practices-summary" class="nav-link" data-scroll-target="#best-practices-summary">Best Practices Summary</a>
  <ul class="collapse">
  <li><a href="#key-dplyr-principles" id="toc-key-dplyr-principles" class="nav-link" data-scroll-target="#key-dplyr-principles">Key dplyr Principles</a></li>
  <li><a href="#performance-tips" id="toc-performance-tips" class="nav-link" data-scroll-target="#performance-tips">Performance Tips</a></li>
  <li><a href="#code-organization" id="toc-code-organization" class="nav-link" data-scroll-target="#code-organization">Code Organization</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="..\data_manipulation_examples.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Manipulation Examples</h1>
<p class="subtitle lead">Practical Data Manipulation Examples with dplyr</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-manipulation-examples" class="level1">
<h1>ðŸ“Š Data Manipulation Examples</h1>
<p><strong>Practical Data Manipulation Examples with dplyr</strong><br>
Module 2-3: Data Manipulation, Filtering, Joins, and Summaries</p>
<p>This guide demonstrates essential dplyr operations for clinical data analysis, covering core functions and techniques used in data manipulation workflows.</p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>Data manipulation is fundamental to clinical programming. This document covers:</p>
<ul>
<li>Essential dplyr functions (<code>select</code>, <code>filter</code>, <code>mutate</code>, <code>summarise</code>)</li>
<li>Data reshaping and transformation techniques</li>
<li>Joining datasets and handling missing data</li>
<li>Group-wise operations and statistical summaries</li>
</ul>
</section>
<section id="required-libraries" class="level2">
<h2 class="anchored" data-anchor-id="required-libraries">Required Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Data Manipulation Examples ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Data Manipulation Examples ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Essential dplyr operations for data analysis</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Essential dplyr operations for data analysis</code></pre>
</div>
</div>
</section>
<section id="sample-sdtm-datasets" class="level2">
<h2 class="anchored" data-anchor-id="sample-sdtm-datasets">Sample SDTM Datasets</h2>
<p>Letâ€™s create sample clinical datasets to demonstrate data manipulation techniques.</p>
<section id="demographics-domain-dm" class="level3">
<h3 class="anchored" data-anchor-id="demographics-domain-dm">Demographics Domain (DM)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load validated SDTM datasets (in production, these would be from validated sources)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Demographics Domain (DM)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dm_sdtm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">STUDYID =</span> <span class="fu">rep</span>(<span class="st">"ABC-123"</span>, <span class="dv">20</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">DOMAIN =</span> <span class="fu">rep</span>(<span class="st">"DM"</span>, <span class="dv">20</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">USUBJID =</span> <span class="fu">paste0</span>(<span class="st">"ABC-123-"</span>, <span class="fu">sprintf</span>(<span class="st">"%03d"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJID =</span> <span class="fu">sprintf</span>(<span class="st">"%03d"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">SITEID =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"001"</span>, <span class="st">"002"</span>, <span class="st">"003"</span>), <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">BRTHDTC =</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1950-01-01"</span>), <span class="fu">as.Date</span>(<span class="st">"1990-12-31"</span>), <span class="at">by =</span> <span class="st">"day"</span>), <span class="dv">20</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">SEX =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">RACE =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"WHITE"</span>, <span class="st">"BLACK OR AFRICAN AMERICAN"</span>, <span class="st">"ASIAN"</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ETHNIC =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"HISPANIC OR LATINO"</span>, <span class="st">"NOT HISPANIC OR LATINO"</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ARMCD =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"PBO"</span>, <span class="st">"TRT"</span>), <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">RFSTDTC =</span> <span class="fu">as.Date</span>(<span class="st">"2024-01-15"</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">RFENDTC =</span> <span class="fu">as.Date</span>(<span class="st">"2024-04-15"</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ARM =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    ARMCD <span class="sc">==</span> <span class="st">"PBO"</span> <span class="sc">~</span> <span class="st">"Placebo"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    ARMCD <span class="sc">==</span> <span class="st">"TRT"</span> <span class="sc">~</span> <span class="st">"Study Drug 10mg"</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Demographics Domain (DM):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Demographics Domain (DM):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_sdtm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   STUDYID DOMAIN     USUBJID SUBJID SITEID    BRTHDTC SEX
1  ABC-123     DM ABC-123-001    001    001 1960-08-03   M
2  ABC-123     DM ABC-123-002    002    002 1959-01-23   M
3  ABC-123     DM ABC-123-003    003    003 1979-01-01   M
4  ABC-123     DM ABC-123-004    004    001 1990-02-04   F
5  ABC-123     DM ABC-123-005    005    002 1955-07-06   F
6  ABC-123     DM ABC-123-006    006    003 1976-11-29   M
7  ABC-123     DM ABC-123-007    007    001 1972-11-28   F
8  ABC-123     DM ABC-123-008    008    002 1973-08-05   F
9  ABC-123     DM ABC-123-009    009    003 1963-09-06   F
10 ABC-123     DM ABC-123-010    010    001 1986-10-10   F
11 ABC-123     DM ABC-123-011    011    002 1983-06-18   M
12 ABC-123     DM ABC-123-012    012    003 1963-07-13   M
13 ABC-123     DM ABC-123-013    013    001 1962-09-10   M
14 ABC-123     DM ABC-123-014    014    002 1982-02-11   M
15 ABC-123     DM ABC-123-015    015    003 1957-09-28   M
16 ABC-123     DM ABC-123-016    016    001 1982-06-12   M
17 ABC-123     DM ABC-123-017    017    002 1955-01-08   M
18 ABC-123     DM ABC-123-018    018    003 1953-02-16   M
19 ABC-123     DM ABC-123-019    019    001 1963-01-17   M
20 ABC-123     DM ABC-123-020    020    002 1972-05-02   M
                        RACE                 ETHNIC ARMCD    RFSTDTC    RFENDTC
1  BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
2                      WHITE     HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
3  BLACK OR AFRICAN AMERICAN NOT HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
4                      WHITE     HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
5                      ASIAN NOT HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
6  BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
7                      WHITE     HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
8  BLACK OR AFRICAN AMERICAN NOT HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
9                      ASIAN NOT HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
10                     ASIAN NOT HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
11 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
12 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
13 BLACK OR AFRICAN AMERICAN NOT HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
14                     WHITE     HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
15                     WHITE NOT HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
16                     ASIAN NOT HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
17 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
18 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
19 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO   PBO 2024-01-15 2024-04-15
20                     WHITE NOT HISPANIC OR LATINO   TRT 2024-01-15 2024-04-15
               ARM
1          Placebo
2  Study Drug 10mg
3          Placebo
4  Study Drug 10mg
5          Placebo
6  Study Drug 10mg
7          Placebo
8  Study Drug 10mg
9          Placebo
10 Study Drug 10mg
11         Placebo
12 Study Drug 10mg
13         Placebo
14 Study Drug 10mg
15         Placebo
16 Study Drug 10mg
17         Placebo
18 Study Drug 10mg
19         Placebo
20 Study Drug 10mg</code></pre>
</div>
</div>
</section>
<section id="vital-signs-domain-vs" class="level3">
<h3 class="anchored" data-anchor-id="vital-signs-domain-vs">Vital Signs Domain (VS)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vital Signs Domain (VS) - Multiple records per subject</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>vs_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(dm_sdtm<span class="sc">$</span>USUBJID[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="cf">function</span>(subj) {</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  visits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BASELINE"</span>, <span class="st">"WEEK 2"</span>, <span class="st">"WEEK 4"</span>, <span class="st">"WEEK 8"</span>, <span class="st">"WEEK 12"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">STUDYID =</span> <span class="st">"ABC-123"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">DOMAIN =</span> <span class="st">"VS"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">USUBJID =</span> subj,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">VISIT =</span> <span class="fu">rep</span>(visits, <span class="dv">3</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">VISITNUM =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">VSTESTCD =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"SYSBP"</span>, <span class="st">"DIABP"</span>, <span class="st">"PULSE"</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">VSTEST =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Systolic Blood Pressure"</span>, <span class="st">"Diastolic Blood Pressure"</span>, <span class="st">"Pulse Rate"</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">VSORRES =</span> <span class="fu">c</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">125</span>, <span class="dv">15</span>)),  <span class="co"># Systolic BP</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">80</span>, <span class="dv">10</span>)),   <span class="co"># Diastolic BP  </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">70</span>, <span class="dv">12</span>))    <span class="co"># Pulse</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">VSORRESU =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"mmHg"</span>, <span class="st">"mmHg"</span>, <span class="st">"beats/min"</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">VSDTC =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2024-01-15"</span>), <span class="at">by =</span> <span class="st">"2 weeks"</span>, <span class="at">length.out =</span> <span class="dv">5</span>), <span class="dv">3</span>),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>vs_sdtm <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, vs_list) <span class="sc">%&gt;%</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(USUBJID, VSTESTCD, VISITNUM)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Vital Signs Domain (VS) - First 15 records:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Vital Signs Domain (VS) - First 15 records:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vs_sdtm <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   STUDYID DOMAIN     USUBJID    VISIT VISITNUM VSTESTCD
1  ABC-123     VS ABC-123-001 BASELINE        1    DIABP
2  ABC-123     VS ABC-123-001   WEEK 2        2    DIABP
3  ABC-123     VS ABC-123-001   WEEK 4        3    DIABP
4  ABC-123     VS ABC-123-001   WEEK 8        4    DIABP
5  ABC-123     VS ABC-123-001  WEEK 12        5    DIABP
6  ABC-123     VS ABC-123-001 BASELINE        1    PULSE
7  ABC-123     VS ABC-123-001   WEEK 2        2    PULSE
8  ABC-123     VS ABC-123-001   WEEK 4        3    PULSE
9  ABC-123     VS ABC-123-001   WEEK 8        4    PULSE
10 ABC-123     VS ABC-123-001  WEEK 12        5    PULSE
11 ABC-123     VS ABC-123-001 BASELINE        1    SYSBP
12 ABC-123     VS ABC-123-001   WEEK 2        2    SYSBP
13 ABC-123     VS ABC-123-001   WEEK 4        3    SYSBP
14 ABC-123     VS ABC-123-001   WEEK 8        4    SYSBP
15 ABC-123     VS ABC-123-001  WEEK 12        5    SYSBP
                     VSTEST VSORRES  VSORRESU      VSDTC
1  Diastolic Blood Pressure      85      mmHg 2024-01-15
2  Diastolic Blood Pressure      67      mmHg 2024-01-29
3  Diastolic Blood Pressure      88      mmHg 2024-02-12
4  Diastolic Blood Pressure      61      mmHg 2024-02-26
5  Diastolic Blood Pressure      68      mmHg 2024-03-11
6                Pulse Rate      84 beats/min 2024-01-15
7                Pulse Rate      54 beats/min 2024-01-29
8                Pulse Rate      57 beats/min 2024-02-12
9                Pulse Rate      65 beats/min 2024-02-26
10               Pulse Rate      72 beats/min 2024-03-11
11  Systolic Blood Pressure     102      mmHg 2024-01-15
12  Systolic Blood Pressure     142      mmHg 2024-01-29
13  Systolic Blood Pressure     130      mmHg 2024-02-12
14  Systolic Blood Pressure     128      mmHg 2024-02-26
15  Systolic Blood Pressure     129      mmHg 2024-03-11</code></pre>
</div>
</div>
</section>
<section id="adverse-events-domain-ae" class="level3">
<h3 class="anchored" data-anchor-id="adverse-events-domain-ae">Adverse Events Domain (AE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adverse Events Domain (AE)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ae_sdtm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">STUDYID =</span> <span class="fu">rep</span>(<span class="st">"ABC-123"</span>, <span class="dv">12</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">DOMAIN =</span> <span class="fu">rep</span>(<span class="st">"AE"</span>, <span class="dv">12</span>), </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">USUBJID =</span> <span class="fu">sample</span>(dm_sdtm<span class="sc">$</span>USUBJID, <span class="dv">12</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">AEDECOD =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Headache"</span>, <span class="st">"Nausea"</span>, <span class="st">"Dizziness"</span>, <span class="st">"Fatigue"</span>, <span class="st">"Insomnia"</span>), <span class="dv">12</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">AESEV =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"MILD"</span>, <span class="st">"MODERATE"</span>, <span class="st">"SEVERE"</span>), <span class="dv">12</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>)),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">AEREL =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"RELATED"</span>, <span class="st">"NOT RELATED"</span>, <span class="st">"POSSIBLY RELATED"</span>), <span class="dv">12</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AESTDTC =</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2024-01-20"</span>), <span class="fu">as.Date</span>(<span class="st">"2024-04-10"</span>), <span class="at">by =</span> <span class="st">"day"</span>), <span class="dv">12</span>),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">AEENDTC =</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2024-02-01"</span>), <span class="fu">as.Date</span>(<span class="st">"2024-04-15"</span>), <span class="at">by =</span> <span class="st">"day"</span>), <span class="dv">12</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(USUBJID, AESTDTC)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Adverse Events Domain (AE):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adverse Events Domain (AE):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ae_sdtm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   STUDYID DOMAIN     USUBJID   AEDECOD    AESEV            AEREL    AESTDTC
1  ABC-123     AE ABC-123-003 Dizziness     MILD POSSIBLY RELATED 2024-03-29
2  ABC-123     AE ABC-123-004  Insomnia     MILD POSSIBLY RELATED 2024-02-24
3  ABC-123     AE ABC-123-004    Nausea     MILD POSSIBLY RELATED 2024-04-08
4  ABC-123     AE ABC-123-009  Headache     MILD      NOT RELATED 2024-02-05
5  ABC-123     AE ABC-123-009  Insomnia MODERATE          RELATED 2024-03-28
6  ABC-123     AE ABC-123-010  Headache     MILD          RELATED 2024-04-06
7  ABC-123     AE ABC-123-015  Insomnia MODERATE          RELATED 2024-02-07
8  ABC-123     AE ABC-123-015    Nausea MODERATE      NOT RELATED 2024-03-25
9  ABC-123     AE ABC-123-016    Nausea MODERATE          RELATED 2024-02-26
10 ABC-123     AE ABC-123-018    Nausea     MILD          RELATED 2024-03-04
11 ABC-123     AE ABC-123-019    Nausea   SEVERE      NOT RELATED 2024-03-07
12 ABC-123     AE ABC-123-020 Dizziness     MILD POSSIBLY RELATED 2024-03-16
      AEENDTC
1  2024-02-09
2  2024-04-09
3  2024-03-13
4  2024-02-20
5  2024-03-16
6  2024-02-08
7  2024-02-04
8  2024-02-16
9  2024-02-29
10 2024-02-28
11 2024-04-03
12 2024-03-06</code></pre>
</div>
</div>
</section>
</section>
<section id="core-dplyr-operations" class="level2">
<h2 class="anchored" data-anchor-id="core-dplyr-operations">Core dplyr Operations</h2>
<section id="selecting-columns" class="level3">
<h3 class="anchored" data-anchor-id="selecting-columns">1. Selecting Columns</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== SELECT Operations ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== SELECT Operations ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific columns</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dm_basic <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, SEX, RACE, ARM)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Basic demographics (selected columns):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Basic demographics (selected columns):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_basic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID SEX                      RACE             ARM
1  ABC-123-001   M BLACK OR AFRICAN AMERICAN         Placebo
2  ABC-123-002   M                     WHITE Study Drug 10mg
3  ABC-123-003   M BLACK OR AFRICAN AMERICAN         Placebo
4  ABC-123-004   F                     WHITE Study Drug 10mg
5  ABC-123-005   F                     ASIAN         Placebo
6  ABC-123-006   M BLACK OR AFRICAN AMERICAN Study Drug 10mg
7  ABC-123-007   F                     WHITE         Placebo
8  ABC-123-008   F BLACK OR AFRICAN AMERICAN Study Drug 10mg
9  ABC-123-009   F                     ASIAN         Placebo
10 ABC-123-010   F                     ASIAN Study Drug 10mg
11 ABC-123-011   M BLACK OR AFRICAN AMERICAN         Placebo
12 ABC-123-012   M BLACK OR AFRICAN AMERICAN Study Drug 10mg
13 ABC-123-013   M BLACK OR AFRICAN AMERICAN         Placebo
14 ABC-123-014   M                     WHITE Study Drug 10mg
15 ABC-123-015   M                     WHITE         Placebo
16 ABC-123-016   M                     ASIAN Study Drug 10mg
17 ABC-123-017   M BLACK OR AFRICAN AMERICAN         Placebo
18 ABC-123-018   M BLACK OR AFRICAN AMERICAN Study Drug 10mg
19 ABC-123-019   M BLACK OR AFRICAN AMERICAN         Placebo
20 ABC-123-020   M                     WHITE Study Drug 10mg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns using patterns</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>dm_dates <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, <span class="fu">ends_with</span>(<span class="st">"DTC"</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Date columns:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nDate columns:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_dates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID    BRTHDTC    RFSTDTC    RFENDTC
1  ABC-123-001 1960-08-03 2024-01-15 2024-04-15
2  ABC-123-002 1959-01-23 2024-01-15 2024-04-15
3  ABC-123-003 1979-01-01 2024-01-15 2024-04-15
4  ABC-123-004 1990-02-04 2024-01-15 2024-04-15
5  ABC-123-005 1955-07-06 2024-01-15 2024-04-15
6  ABC-123-006 1976-11-29 2024-01-15 2024-04-15
7  ABC-123-007 1972-11-28 2024-01-15 2024-04-15
8  ABC-123-008 1973-08-05 2024-01-15 2024-04-15
9  ABC-123-009 1963-09-06 2024-01-15 2024-04-15
10 ABC-123-010 1986-10-10 2024-01-15 2024-04-15
11 ABC-123-011 1983-06-18 2024-01-15 2024-04-15
12 ABC-123-012 1963-07-13 2024-01-15 2024-04-15
13 ABC-123-013 1962-09-10 2024-01-15 2024-04-15
14 ABC-123-014 1982-02-11 2024-01-15 2024-04-15
15 ABC-123-015 1957-09-28 2024-01-15 2024-04-15
16 ABC-123-016 1982-06-12 2024-01-15 2024-04-15
17 ABC-123-017 1955-01-08 2024-01-15 2024-04-15
18 ABC-123-018 1953-02-16 2024-01-15 2024-04-15
19 ABC-123-019 1963-01-17 2024-01-15 2024-04-15
20 ABC-123-020 1972-05-02 2024-01-15 2024-04-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select and rename columns</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>dm_renamed <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Subject_ID =</span> USUBJID,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gender =</span> SEX,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> ARM,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Start_Date =</span> RFSTDTC</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Renamed columns:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nRenamed columns:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(dm_renamed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Subject_ID Gender       Treatment Start_Date
1 ABC-123-001      M         Placebo 2024-01-15
2 ABC-123-002      M Study Drug 10mg 2024-01-15
3 ABC-123-003      M         Placebo 2024-01-15
4 ABC-123-004      F Study Drug 10mg 2024-01-15
5 ABC-123-005      F         Placebo 2024-01-15
6 ABC-123-006      M Study Drug 10mg 2024-01-15</code></pre>
</div>
</div>
</section>
<section id="filtering-rows" class="level3">
<h3 class="anchored" data-anchor-id="filtering-rows">2. Filtering Rows</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== FILTER Operations ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== FILTER Operations ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple filtering</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>males_only <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="st">"M"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Male subjects only:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Male subjects only:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(males_only <span class="sc">%&gt;%</span> <span class="fu">select</span>(USUBJID, SEX, ARM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID SEX             ARM
1  ABC-123-001   M         Placebo
2  ABC-123-002   M Study Drug 10mg
3  ABC-123-003   M         Placebo
4  ABC-123-006   M Study Drug 10mg
5  ABC-123-011   M         Placebo
6  ABC-123-012   M Study Drug 10mg
7  ABC-123-013   M         Placebo
8  ABC-123-014   M Study Drug 10mg
9  ABC-123-015   M         Placebo
10 ABC-123-016   M Study Drug 10mg
11 ABC-123-017   M         Placebo
12 ABC-123-018   M Study Drug 10mg
13 ABC-123-019   M         Placebo
14 ABC-123-020   M Study Drug 10mg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple conditions with AND</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>treatment_males <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> ARMCD <span class="sc">==</span> <span class="st">"TRT"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Treatment group males:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nTreatment group males:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(treatment_males <span class="sc">%&gt;%</span> <span class="fu">select</span>(USUBJID, SEX, ARM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      USUBJID SEX             ARM
1 ABC-123-002   M Study Drug 10mg
2 ABC-123-006   M Study Drug 10mg
3 ABC-123-012   M Study Drug 10mg
4 ABC-123-014   M Study Drug 10mg
5 ABC-123-016   M Study Drug 10mg
6 ABC-123-018   M Study Drug 10mg
7 ABC-123-020   M Study Drug 10mg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple conditions with OR</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>minority_subjects <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RACE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"BLACK OR AFRICAN AMERICAN"</span>, <span class="st">"ASIAN"</span>) <span class="sc">|</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>         ETHNIC <span class="sc">==</span> <span class="st">"HISPANIC OR LATINO"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Minority subjects:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nMinority subjects:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(minority_subjects <span class="sc">%&gt;%</span> <span class="fu">select</span>(USUBJID, RACE, ETHNIC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID                      RACE                 ETHNIC
1  ABC-123-001 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO
2  ABC-123-002                     WHITE     HISPANIC OR LATINO
3  ABC-123-003 BLACK OR AFRICAN AMERICAN NOT HISPANIC OR LATINO
4  ABC-123-004                     WHITE     HISPANIC OR LATINO
5  ABC-123-005                     ASIAN NOT HISPANIC OR LATINO
6  ABC-123-006 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO
7  ABC-123-007                     WHITE     HISPANIC OR LATINO
8  ABC-123-008 BLACK OR AFRICAN AMERICAN NOT HISPANIC OR LATINO
9  ABC-123-009                     ASIAN NOT HISPANIC OR LATINO
10 ABC-123-010                     ASIAN NOT HISPANIC OR LATINO
11 ABC-123-011 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO
12 ABC-123-012 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO
13 ABC-123-013 BLACK OR AFRICAN AMERICAN NOT HISPANIC OR LATINO
14 ABC-123-014                     WHITE     HISPANIC OR LATINO
15 ABC-123-016                     ASIAN NOT HISPANIC OR LATINO
16 ABC-123-017 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO
17 ABC-123-018 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO
18 ABC-123-019 BLACK OR AFRICAN AMERICAN     HISPANIC OR LATINO</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering with date conditions</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>recent_births <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(BRTHDTC <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1980-01-01"</span>))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Subjects born after 1980:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nSubjects born after 1980:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recent_births <span class="sc">%&gt;%</span> <span class="fu">select</span>(USUBJID, BRTHDTC) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(BRTHDTC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      USUBJID    BRTHDTC
1 ABC-123-014 1982-02-11
2 ABC-123-016 1982-06-12
3 ABC-123-011 1983-06-18
4 ABC-123-010 1986-10-10
5 ABC-123-004 1990-02-04</code></pre>
</div>
</div>
</section>
<section id="creating-new-variables" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-variables">3. Creating New Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== MUTATE Operations ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== MUTATE Operations ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate age and create age groups</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>dm_enhanced <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate age at study start</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE =</span> <span class="fu">as.numeric</span>(<span class="fu">floor</span>(<span class="fu">difftime</span>(RFSTDTC, BRTHDTC, <span class="at">units =</span> <span class="st">"days"</span>) <span class="sc">/</span> <span class="fl">365.25</span>)),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create age groups</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGEGROUP =</span> <span class="fu">case_when</span>(</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"18-29"</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"30-49"</span>, </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">~</span> <span class="st">"50-64"</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"65+"</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create binary treatment indicator</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">TREATMENT_FLAG =</span> <span class="fu">if_else</span>(ARMCD <span class="sc">==</span> <span class="st">"TRT"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format treatment description</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">TREATMENT_DESC =</span> <span class="fu">str_to_title</span>(ARM),</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Study duration</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">STUDY_DAYS =</span> <span class="fu">as.numeric</span>(RFENDTC <span class="sc">-</span> RFSTDTC)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Enhanced demographics with calculated variables:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Enhanced demographics with calculated variables:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_enhanced <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(USUBJID, SEX, AGE, AGEGROUP, TREATMENT_DESC, STUDY_DAYS) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">head</span>(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID SEX AGE AGEGROUP  TREATMENT_DESC STUDY_DAYS
1  ABC-123-001   M  63    50-64         Placebo         91
2  ABC-123-002   M  64    50-64 Study Drug 10mg         91
3  ABC-123-003   M  45    30-49         Placebo         91
4  ABC-123-004   F  33    30-49 Study Drug 10mg         91
5  ABC-123-005   F  68      65+         Placebo         91
6  ABC-123-006   M  47    30-49 Study Drug 10mg         91
7  ABC-123-007   F  51    50-64         Placebo         91
8  ABC-123-008   F  50    50-64 Study Drug 10mg         91
9  ABC-123-009   F  60    50-64         Placebo         91
10 ABC-123-010   F  37    30-49 Study Drug 10mg         91</code></pre>
</div>
</div>
</section>
<section id="arranging-data" class="level3">
<h3 class="anchored" data-anchor-id="arranging-data">4. Arranging Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== ARRANGE Operations ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== ARRANGE Operations ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by single variable</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>dm_by_age <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AGE) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, SEX, AGE, ARM)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Subjects sorted by age (ascending):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subjects sorted by age (ascending):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(dm_by_age, <span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      USUBJID SEX AGE             ARM
1 ABC-123-004   F  33 Study Drug 10mg
2 ABC-123-010   F  37 Study Drug 10mg
3 ABC-123-011   M  40         Placebo
4 ABC-123-014   M  41 Study Drug 10mg
5 ABC-123-016   M  41 Study Drug 10mg
6 ABC-123-003   M  45         Placebo
7 ABC-123-006   M  47 Study Drug 10mg
8 ABC-123-008   F  50 Study Drug 10mg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by multiple variables</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>dm_multi_sort <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ARM, <span class="fu">desc</span>(AGE)) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, ARM, SEX, AGE)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sorted by treatment, then age (descending):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nSorted by treatment, then age (descending):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(dm_multi_sort, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID     ARM SEX AGE
1  ABC-123-017 Placebo   M  69
2  ABC-123-005 Placebo   F  68
3  ABC-123-015 Placebo   M  66
4  ABC-123-001 Placebo   M  63
5  ABC-123-013 Placebo   M  61
6  ABC-123-009 Placebo   F  60
7  ABC-123-019 Placebo   M  60
8  ABC-123-007 Placebo   F  51
9  ABC-123-003 Placebo   M  45
10 ABC-123-011 Placebo   M  40</code></pre>
</div>
</div>
</section>
</section>
<section id="group-operations-and-summaries" class="level2">
<h2 class="anchored" data-anchor-id="group-operations-and-summaries">Group Operations and Summaries</h2>
<section id="basic-grouping-and-summarization" class="level3">
<h3 class="anchored" data-anchor-id="basic-grouping-and-summarization">1. Basic Grouping and Summarization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== GROUP BY and SUMMARISE Operations ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== GROUP BY and SUMMARISE Operations ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic summary by treatment group</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>dm_summary <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ARM) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age =</span> <span class="fu">round</span>(<span class="fu">mean</span>(AGE), <span class="dv">1</span>),</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Age =</span> <span class="fu">median</span>(AGE),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min_Age =</span> <span class="fu">min</span>(AGE),</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Age =</span> <span class="fu">max</span>(AGE),</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_Age =</span> <span class="fu">round</span>(<span class="fu">sd</span>(AGE), <span class="dv">1</span>),</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female_N =</span> <span class="fu">sum</span>(SEX <span class="sc">==</span> <span class="st">"F"</span>),</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female_Pct =</span> <span class="fu">round</span>(Female_N <span class="sc">/</span> N <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Demographics summary by treatment:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Demographics summary by treatment:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 9
  ARM           N Mean_Age Median_Age Min_Age Max_Age SD_Age Female_N Female_Pct
  &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;      &lt;dbl&gt;
1 Placebo      10     58.3       60.5      40      69    9.8        3         30
2 Study Drâ€¦    10     49.4       48.5      33      70   12.1        3         30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple grouping variables</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>site_treatment_summary <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SITEID, ARM) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age =</span> <span class="fu">round</span>(<span class="fu">mean</span>(AGE), <span class="dv">1</span>),</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Summary by site and treatment:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nSummary by site and treatment:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(site_treatment_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 4
  SITEID ARM                 N Mean_Age
  &lt;chr&gt;  &lt;chr&gt;           &lt;int&gt;    &lt;dbl&gt;
1 001    Placebo             4     58.8
2 001    Study Drug 10mg     3     37  
3 002    Placebo             3     59  
4 002    Study Drug 10mg     4     51.5
5 003    Placebo             3     57  
6 003    Study Drug 10mg     3     59  </code></pre>
</div>
</div>
</section>
<section id="advanced-grouping-operations" class="level3">
<h3 class="anchored" data-anchor-id="advanced-grouping-operations">2. Advanced Grouping Operations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group-wise calculations with mutate</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>dm_group_calc <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ARM) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Z-score of age within treatment group</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE_ZSCORE =</span> <span class="fu">round</span>((AGE <span class="sc">-</span> <span class="fu">mean</span>(AGE)) <span class="sc">/</span> <span class="fu">sd</span>(AGE), <span class="dv">2</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rank within group</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE_RANK =</span> <span class="fu">rank</span>(AGE),</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group size</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">GROUP_SIZE =</span> <span class="fu">n</span>(),</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Age percentile within group</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE_PERCENTILE =</span> <span class="fu">round</span>(<span class="fu">percent_rank</span>(AGE) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Group-wise calculations:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Group-wise calculations:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_group_calc <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(USUBJID, ARM, AGE, AGE_ZSCORE, AGE_RANK, AGE_PERCENTILE) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">arrange</span>(ARM, AGE_RANK) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">head</span>(<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 Ã— 6
   USUBJID     ARM               AGE AGE_ZSCORE AGE_RANK AGE_PERCENTILE
   &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;
 1 ABC-123-011 Placebo            40      -1.86      1              0  
 2 ABC-123-003 Placebo            45      -1.35      2             11.1
 3 ABC-123-007 Placebo            51      -0.74      3             22.2
 4 ABC-123-009 Placebo            60       0.17      4.5           33.3
 5 ABC-123-019 Placebo            60       0.17      4.5           33.3
 6 ABC-123-013 Placebo            61       0.27      6             55.6
 7 ABC-123-001 Placebo            63       0.48      7             66.7
 8 ABC-123-015 Placebo            66       0.78      8             77.8
 9 ABC-123-005 Placebo            68       0.99      9             88.9
10 ABC-123-017 Placebo            69       1.09     10            100  
11 ABC-123-004 Study Drug 10mg    33      -1.35      1              0  
12 ABC-123-010 Study Drug 10mg    37      -1.02      2             11.1</code></pre>
</div>
</div>
</section>
</section>
<section id="data-joining-operations" class="level2">
<h2 class="anchored" data-anchor-id="data-joining-operations">Data Joining Operations</h2>
<section id="inner-joins" class="level3">
<h3 class="anchored" data-anchor-id="inner-joins">1. Inner Joins</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== JOIN Operations ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== JOIN Operations ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inner join: Only subjects with both demographics and AEs</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>dm_ae_inner <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ae_sdtm, <span class="at">by =</span> <span class="st">"USUBJID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, SEX, ARM, AEDECOD, AESEV, AEREL)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Inner join - Subjects with AEs:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Inner join - Subjects with AEs:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_ae_inner)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID SEX             ARM   AEDECOD    AESEV            AEREL
1  ABC-123-003   M         Placebo Dizziness     MILD POSSIBLY RELATED
2  ABC-123-004   F Study Drug 10mg  Insomnia     MILD POSSIBLY RELATED
3  ABC-123-004   F Study Drug 10mg    Nausea     MILD POSSIBLY RELATED
4  ABC-123-009   F         Placebo  Headache     MILD      NOT RELATED
5  ABC-123-009   F         Placebo  Insomnia MODERATE          RELATED
6  ABC-123-010   F Study Drug 10mg  Headache     MILD          RELATED
7  ABC-123-015   M         Placebo  Insomnia MODERATE          RELATED
8  ABC-123-015   M         Placebo    Nausea MODERATE      NOT RELATED
9  ABC-123-016   M Study Drug 10mg    Nausea MODERATE          RELATED
10 ABC-123-018   M Study Drug 10mg    Nausea     MILD          RELATED
11 ABC-123-019   M         Placebo    Nausea   SEVERE      NOT RELATED
12 ABC-123-020   M Study Drug 10mg Dizziness     MILD POSSIBLY RELATED</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left join: All subjects, with AE data where available</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>dm_ae_left <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    ae_sdtm <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(USUBJID) <span class="sc">%&gt;%</span> </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">Total_AEs =</span> <span class="fu">n</span>(),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">Severe_AEs =</span> <span class="fu">sum</span>(AESEV <span class="sc">==</span> <span class="st">"SEVERE"</span>),</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">Related_AEs =</span> <span class="fu">sum</span>(AEREL <span class="sc">==</span> <span class="st">"RELATED"</span>),</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"USUBJID"</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_AEs =</span> <span class="fu">replace_na</span>(Total_AEs, <span class="dv">0</span>),</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Severe_AEs =</span> <span class="fu">replace_na</span>(Severe_AEs, <span class="dv">0</span>),</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Related_AEs =</span> <span class="fu">replace_na</span>(Related_AEs, <span class="dv">0</span>)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Left join - All subjects with AE counts:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nLeft join - All subjects with AE counts:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_ae_left <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(USUBJID, ARM, Total_AEs, Severe_AEs, Related_AEs) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_AEs)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID             ARM Total_AEs Severe_AEs Related_AEs
1  ABC-123-004 Study Drug 10mg         2          0           0
2  ABC-123-009         Placebo         2          0           1
3  ABC-123-015         Placebo         2          0           1
4  ABC-123-003         Placebo         1          0           0
5  ABC-123-010 Study Drug 10mg         1          0           1
6  ABC-123-016 Study Drug 10mg         1          0           1
7  ABC-123-018 Study Drug 10mg         1          0           1
8  ABC-123-019         Placebo         1          1           0
9  ABC-123-020 Study Drug 10mg         1          0           0
10 ABC-123-001         Placebo         0          0           0
11 ABC-123-002 Study Drug 10mg         0          0           0
12 ABC-123-005         Placebo         0          0           0
13 ABC-123-006 Study Drug 10mg         0          0           0
14 ABC-123-007         Placebo         0          0           0
15 ABC-123-008 Study Drug 10mg         0          0           0
16 ABC-123-011         Placebo         0          0           0
17 ABC-123-012 Study Drug 10mg         0          0           0
18 ABC-123-013         Placebo         0          0           0
19 ABC-123-014 Study Drug 10mg         0          0           0
20 ABC-123-017         Placebo         0          0           0</code></pre>
</div>
</div>
</section>
<section id="complex-joins-with-vital-signs" class="level3">
<h3 class="anchored" data-anchor-id="complex-joins-with-vital-signs">2. Complex Joins with Vital Signs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join demographics with baseline vital signs</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>baseline_vitals <span class="ot">&lt;-</span> vs_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VISIT <span class="sc">==</span> <span class="st">"BASELINE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, VSTESTCD, VSORRES) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> VSTESTCD,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> VSORRES,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"BL_"</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>dm_vitals <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(baseline_vitals, <span class="at">by =</span> <span class="st">"USUBJID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(BL_SYSBP))  <span class="co"># Only subjects with baseline vitals</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Demographics with baseline vitals:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Demographics with baseline vitals:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_vitals <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(USUBJID, ARM, AGE, BL_SYSBP, BL_DIABP, BL_PULSE) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">head</span>(<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      USUBJID             ARM AGE BL_SYSBP BL_DIABP BL_PULSE
1 ABC-123-001         Placebo  63      102       85       84
2 ABC-123-002 Study Drug 10mg  64      115       91       67
3 ABC-123-003         Placebo  45      129       61       79
4 ABC-123-004 Study Drug 10mg  33      149       87       99
5 ABC-123-005         Placebo  68      134       92       93
6 ABC-123-006 Study Drug 10mg  47      122       80       82
7 ABC-123-007         Placebo  51       97       75       74
8 ABC-123-008 Study Drug 10mg  50      113       88       70</code></pre>
</div>
</div>
</section>
</section>
<section id="advanced-data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="advanced-data-manipulation">Advanced Data Manipulation</h2>
<section id="conditional-operations" class="level3">
<h3 class="anchored" data-anchor-id="conditional-operations">1. Conditional Operations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Conditional Operations ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Conditional Operations ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complex conditional logic</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>dm_risk_assessment <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Risk categorization based on multiple factors</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">RISK_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&gt;=</span> <span class="dv">65</span> <span class="sc">&amp;</span> SEX <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="st">"High Risk"</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&gt;=</span> <span class="dv">65</span> <span class="sc">&amp;</span> SEX <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">~</span> <span class="st">"Moderate Risk"</span>,</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> SEX <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="st">"Moderate Risk"</span>,</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> SEX <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">~</span> <span class="st">"Low Risk"</span>,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Eligibility criteria</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ELIGIBLE =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">~</span> <span class="st">"Too Young"</span>,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>      AGE <span class="sc">&gt;</span> <span class="dv">75</span> <span class="sc">~</span> <span class="st">"Too Old"</span>, </span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Eligible"</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Priority scoring</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">PRIORITY_SCORE =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>      ARMCD <span class="sc">==</span> <span class="st">"TRT"</span> <span class="sc">&amp;</span> AGE <span class="sc">&gt;=</span> <span class="dv">65</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>      ARMCD <span class="sc">==</span> <span class="st">"TRT"</span> <span class="sc">&amp;</span> AGE <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>      ARMCD <span class="sc">==</span> <span class="st">"PBO"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Risk assessment and eligibility:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Risk assessment and eligibility:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_risk_assessment <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(USUBJID, AGE, SEX, ARM, RISK_CATEGORY, ELIGIBLE, PRIORITY_SCORE) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">arrange</span>(<span class="fu">desc</span>(PRIORITY_SCORE)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USUBJID AGE SEX             ARM RISK_CATEGORY ELIGIBLE PRIORITY_SCORE
1  ABC-123-018  70   M Study Drug 10mg     High Risk Eligible              3
2  ABC-123-002  64   M Study Drug 10mg Moderate Risk Eligible              2
3  ABC-123-004  33   F Study Drug 10mg      Low Risk Eligible              2
4  ABC-123-006  47   M Study Drug 10mg Moderate Risk Eligible              2
5  ABC-123-008  50   F Study Drug 10mg      Low Risk Eligible              2
6  ABC-123-010  37   F Study Drug 10mg      Low Risk Eligible              2
7  ABC-123-012  60   M Study Drug 10mg Moderate Risk Eligible              2
8  ABC-123-014  41   M Study Drug 10mg Moderate Risk Eligible              2
9  ABC-123-016  41   M Study Drug 10mg Moderate Risk Eligible              2
10 ABC-123-020  51   M Study Drug 10mg Moderate Risk Eligible              2
11 ABC-123-001  63   M         Placebo Moderate Risk Eligible              1
12 ABC-123-003  45   M         Placebo Moderate Risk Eligible              1
13 ABC-123-005  68   F         Placebo Moderate Risk Eligible              1
14 ABC-123-007  51   F         Placebo      Low Risk Eligible              1
15 ABC-123-009  60   F         Placebo      Low Risk Eligible              1
16 ABC-123-011  40   M         Placebo Moderate Risk Eligible              1
17 ABC-123-013  61   M         Placebo Moderate Risk Eligible              1
18 ABC-123-015  66   M         Placebo     High Risk Eligible              1
19 ABC-123-017  69   M         Placebo     High Risk Eligible              1
20 ABC-123-019  60   M         Placebo Moderate Risk Eligible              1</code></pre>
</div>
</div>
</section>
<section id="string-manipulation" class="level3">
<h3 class="anchored" data-anchor-id="string-manipulation">2. String Manipulation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced string operations</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>dm_strings <span class="ot">&lt;-</span> dm_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract site region from site ID</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">REGION =</span> <span class="fu">case_when</span>(</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(SITEID, <span class="st">"^00[1-2]"</span>) <span class="sc">~</span> <span class="st">"North America"</span>,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(SITEID, <span class="st">"^003"</span>) <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format subject ID for display</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">DISPLAY_ID =</span> <span class="fu">str_replace</span>(USUBJID, <span class="st">"ABC-123-"</span>, <span class="st">"Subject "</span>),</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create composite descriptions</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">SUBJECT_DESC =</span> <span class="fu">paste</span>(SEX, RACE, <span class="st">"subject in"</span>, ARM, <span class="st">"group"</span>),</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Clean and standardize race</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">RACE_CLEAN =</span> <span class="fu">str_to_title</span>(<span class="fu">str_to_lower</span>(RACE))</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"String manipulation examples:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "String manipulation examples:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dm_strings <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(USUBJID, DISPLAY_ID, REGION, SUBJECT_DESC) <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">head</span>(<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      USUBJID  DISPLAY_ID        REGION
1 ABC-123-001 Subject 001 North America
2 ABC-123-002 Subject 002 North America
3 ABC-123-003 Subject 003        Europe
4 ABC-123-004 Subject 004 North America
5 ABC-123-005 Subject 005 North America
6 ABC-123-006 Subject 006        Europe
7 ABC-123-007 Subject 007 North America
8 ABC-123-008 Subject 008 North America
                                                  SUBJECT_DESC
1         M BLACK OR AFRICAN AMERICAN subject in Placebo group
2                     M WHITE subject in Study Drug 10mg group
3         M BLACK OR AFRICAN AMERICAN subject in Placebo group
4                     F WHITE subject in Study Drug 10mg group
5                             F ASIAN subject in Placebo group
6 M BLACK OR AFRICAN AMERICAN subject in Study Drug 10mg group
7                             F WHITE subject in Placebo group
8 F BLACK OR AFRICAN AMERICAN subject in Study Drug 10mg group</code></pre>
</div>
</div>
</section>
<section id="window-functions" class="level3">
<h3 class="anchored" data-anchor-id="window-functions">3. Window Functions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Window functions for rankings and running calculations</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>vs_analysis <span class="ot">&lt;-</span> vs_sdtm <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VSTESTCD <span class="sc">==</span> <span class="st">"SYSBP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(USUBJID) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(USUBJID, VISITNUM) <span class="sc">%&gt;%</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Running mean</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">RUNNING_MEAN =</span> <span class="fu">round</span>(<span class="fu">cummean</span>(VSORRES), <span class="dv">1</span>),</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Change from baseline</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">CHANGE_BL =</span> VSORRES <span class="sc">-</span> <span class="fu">first</span>(VSORRES),</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Percent change from baseline  </span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">PCT_CHANGE_BL =</span> <span class="fu">round</span>((VSORRES <span class="sc">-</span> <span class="fu">first</span>(VSORRES)) <span class="sc">/</span> <span class="fu">first</span>(VSORRES) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Visit rank (within subject)</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">VISIT_RANK =</span> <span class="fu">row_number</span>(),</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flag last visit</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">LAST_VISIT =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">n</span>(), <span class="st">"Y"</span>, <span class="st">"N"</span>)</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Window functions - Systolic BP analysis:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Window functions - Systolic BP analysis:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vs_analysis <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(USUBJID, VISIT, VSORRES, RUNNING_MEAN, CHANGE_BL, PCT_CHANGE_BL, LAST_VISIT) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">head</span>(<span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 Ã— 7
   USUBJID     VISIT    VSORRES RUNNING_MEAN CHANGE_BL PCT_CHANGE_BL LAST_VISIT
   &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;     
 1 ABC-123-001 BASELINE     102         102          0           0   N         
 2 ABC-123-001 WEEK 2       142         122         40          39.2 N         
 3 ABC-123-001 WEEK 4       130         125.        28          27.5 N         
 4 ABC-123-001 WEEK 8       128         126.        26          25.5 N         
 5 ABC-123-001 WEEK 12      129         126.        27          26.5 Y         
 6 ABC-123-002 BASELINE     115         115          0           0   N         
 7 ABC-123-002 WEEK 2       111         113         -4          -3.5 N         
 8 ABC-123-002 WEEK 4       106         111.        -9          -7.8 N         
 9 ABC-123-002 WEEK 8       153         121.        38          33   N         
10 ABC-123-002 WEEK 12      106         118.        -9          -7.8 Y         
11 ABC-123-003 BASELINE     129         129          0           0   N         
12 ABC-123-003 WEEK 2        94         112.       -35         -27.1 N         
13 ABC-123-003 WEEK 4       127         117.        -2          -1.6 N         
14 ABC-123-003 WEEK 8        98         112        -31         -24   N         
15 ABC-123-003 WEEK 12      105         111.       -24         -18.6 Y         </code></pre>
</div>
</div>
</section>
</section>
<section id="summary-statistics-by-group" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-by-group">Summary Statistics by Group</h2>
<section id="treatment-group-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="treatment-group-comparisons">1. Treatment Group Comparisons</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprehensive treatment group comparison</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>treatment_comparison <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ARM) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample size</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Age statistics</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(AGE), <span class="dv">1</span>),</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(AGE), <span class="dv">1</span>),</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Median =</span> <span class="fu">median</span>(AGE),</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Min =</span> <span class="fu">min</span>(AGE),</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Max =</span> <span class="fu">max</span>(AGE),</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Gender distribution</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female_N =</span> <span class="fu">sum</span>(SEX <span class="sc">==</span> <span class="st">"F"</span>),</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female_Pct =</span> <span class="fu">round</span>(Female_N <span class="sc">/</span> N <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male_N =</span> <span class="fu">sum</span>(SEX <span class="sc">==</span> <span class="st">"M"</span>),</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male_Pct =</span> <span class="fu">round</span>(Male_N <span class="sc">/</span> N <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Race distribution</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">White_N =</span> <span class="fu">sum</span>(RACE <span class="sc">==</span> <span class="st">"WHITE"</span>),</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">White_Pct =</span> <span class="fu">round</span>(White_N <span class="sc">/</span> N <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Treatment group comparison:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Treatment group comparison:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(treatment_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 13
  ARM           N Age_Mean Age_SD Age_Median Age_Min Age_Max Female_N Female_Pct
  &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;int&gt;      &lt;dbl&gt;
1 Placebo      10     58.3    9.8       60.5      40      69        3         30
2 Study Drâ€¦    10     49.4   12.1       48.5      33      70        3         30
# â„¹ 4 more variables: Male_N &lt;int&gt;, Male_Pct &lt;dbl&gt;, White_N &lt;int&gt;,
#   White_Pct &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="site-level-analysis" class="level3">
<h3 class="anchored" data-anchor-id="site-level-analysis">2. Site-Level Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Site-level enrollment and demographics</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>site_analysis <span class="ot">&lt;-</span> dm_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SITEID) <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Enrolled =</span> <span class="fu">n</span>(),</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment_N =</span> <span class="fu">sum</span>(ARMCD <span class="sc">==</span> <span class="st">"TRT"</span>),</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Placebo_N =</span> <span class="fu">sum</span>(ARMCD <span class="sc">==</span> <span class="st">"PBO"</span>),</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Randomization_Ratio =</span> <span class="fu">round</span>(Treatment_N <span class="sc">/</span> Placebo_N, <span class="dv">2</span>),</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age =</span> <span class="fu">round</span>(<span class="fu">mean</span>(AGE), <span class="dv">1</span>),</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female_Pct =</span> <span class="fu">round</span>(<span class="fu">sum</span>(SEX <span class="sc">==</span> <span class="st">"F"</span>) <span class="sc">/</span> <span class="fu">n</span>() <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Enrolled))</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Site-level analysis:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Site-level analysis:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(site_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 7
  SITEID Total_Enrolled Treatment_N Placebo_N Randomization_Ratio Mean_Age
  &lt;chr&gt;           &lt;int&gt;       &lt;int&gt;     &lt;int&gt;               &lt;dbl&gt;    &lt;dbl&gt;
1 001                 7           3         4                0.75     49.4
2 002                 7           4         3                1.33     54.7
3 003                 6           3         3                1        58  
# â„¹ 1 more variable: Female_Pct &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="best-practices-summary" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-summary">Best Practices Summary</h2>
<section id="key-dplyr-principles" class="level3">
<h3 class="anchored" data-anchor-id="key-dplyr-principles">Key dplyr Principles</h3>
<ol type="1">
<li><strong>Pipe Operator (<code>%&gt;%</code>)</strong>: Chain operations for readable code</li>
<li><strong>Group Operations</strong>: Use <code>group_by()</code> for category-wise calculations<br>
</li>
<li><strong>Joins</strong>: Choose appropriate join type based on analysis needs</li>
<li><strong>Window Functions</strong>: Leverage for rankings and running calculations</li>
<li><strong>Conditional Logic</strong>: Use <code>case_when()</code> for complex categorizations</li>
</ol>
</section>
<section id="performance-tips" class="level3">
<h3 class="anchored" data-anchor-id="performance-tips">Performance Tips</h3>
<ul>
<li>Filter early to reduce data size</li>
<li>Use <code>select()</code> to keep only needed columns</li>
<li>Leverage vectorized operations over loops</li>
<li>Group operations are generally efficient</li>
<li>Consider <code>data.table</code> for very large datasets</li>
</ul>
</section>
<section id="code-organization" class="level3">
<h3 class="anchored" data-anchor-id="code-organization">Code Organization</h3>
<ul>
<li>Use meaningful variable names</li>
<li>Add comments for complex logic</li>
<li>Break complex operations into steps</li>
<li>Validate results at each step</li>
<li>Document assumptions and business rules</li>
</ul>
<hr>
<p><em>This guide demonstrates essential data manipulation techniques for clinical programming using modern R practices with dplyr.</em></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>